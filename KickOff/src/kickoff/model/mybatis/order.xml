<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="order">
<!-- 주문 테이블에 넣기 -->
<insert id="insertOrder">
   insert into buy values (buyNum_seq.nextval, #{memberNum}, #{subname}, #{subaddr1}, #{subaddr2}, #{subphonenum}, #{price}, #{Aname},
   #{buyamount}, #{asize}, #{articleNum}, SYSDATE, '주문완료', #{sendContent}, 0, 0)
</insert>
<!-- 주문시 수량 마이너스 시키기 -->
<update id="updateOrder" parameterType="kickoff.model.beans.ArticleSizeAmountVO">
	update articleSizeAmount set amount =amount-#{amount} where articleNum=#{articleNum} and asize = #{asize}
</update>

 <select id="selectSizeSelect" resultType="int" parameterType="Map">
	select amount from articleSizeAmount where articleNum=#{articleNum} and Asize= #{Asize}
</select> 

<!-- 주문한 리스트 페이징기능 -->
<select id="selectOrderList" parameterType="kickoff.model.beans.RowNumVO" resultType="kickoff.model.beans.OrderVO">
	select * from (select buyNum, subname, subaddr1, subaddr2, subphonenum, buyamount, price, aname, asize, buydate, buyStatus , sendContent,sendNum,sendpackage, rownum r 
	from (select * from buy order by buyNum desc ) ) 
	where r between #{startRow} and #{endRow}
</select>
<!-- 주문 리스트 카운트 -->
<select id="OrderCount" resultType="int"> 
	select count(*) from buy 
</select>
</mapper> 
